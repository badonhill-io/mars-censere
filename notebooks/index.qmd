---
title: "Censere - a Framework for Numerically Simulating the Human Settlement of Mars"

params:
  dbpathname: /dev/null

author:
  - name: Richard Offer
    url : https://github.com/badonhill-io/mars-censere/
    affiliation: Badon Hill Technologies Ltd.
    affiliation-url: http://badonhill.io/

---

```{r install}
#| echo: FALSE
#| include: FALSE
install.packages("renv")
install.packages("rmarkdown")
install.packages("RSQLite")

install.packages("sqldf")
install.packages("gdata")
```

```{r imports}
#| echo: FALSE
#| include: FALSE
#| cache: FALSE

library(DBI)
library(sqldf)
library(gdata)
library(knitr)

```

```{r load_data}
#| echo: FALSE
#| include: FALSE
#| cache: FALSE

dbfile = params$dbpathname

dbconn <- dbConnect(RSQLite::SQLite(), dbfile)

```

```{r process_data}
#| echo: FALSE
#| include: FALSE
#| cache: FALSE

database_info <- file.info(dbfile, extra_cols = FALSE)
database_size <- humanReadable(file.size(dbfile), units="auto", standard="Unix", digits=0 )
database_mtime <- file.mtime( dbfile )

summary <- dbReadTable(dbconn, "summary")
simulations <- dbReadTable(dbconn, "simulations")

num_simulations <- nrow(simulations)
```

## Abstract

Censere is a numerical simulation framework for modelling the human settlement of Mars.

This report is autogenerated from a supplied simulation run.



## Input Summary

::: {.callout-note}

|          Value | Details                    |
|---------------:|:---------------------------|
|           Path | `{r} dbfile` |
|      File Size | `{r} database_size` bytes     |
|  Last Modified | `{r} database_mtime`    |
|  # Simulations | `{r} num_simulations`   |
:::


## Database Contents

```{r, results="asis"}
#| echo: FALSE
#| cache: FALSE

for ( i in 1:num_simulations ) {
  sim <- simulations[i, ]

  cat( "### Simulation #", i, " ", sim$simulation_id, "\n\n")

  cat( "##### Notes\n")

  cat( sim$notes, "\n\n")

  cat("|          Value | Details                    |\n")
  cat("|---------------:|:---------------------------|\n")
  cat("|  Random Seed | ", sim$random_seed, " |\n") 
  cat("|  Simulation Started | ", sim$begin_datetime, " |\n") 
  cat("|  Initial Mission Lands | ", sim$initial_mission_lands , " |\n")
  cat("|  Mission Ends | ", sim$mission_ends, " |\n")
  cat("|  Final Population | ", sim$final_population, " |\n")
  cat("|  Model Inputs | ", gsub('@', '<br />', sim$args), " |\n")

}

```
